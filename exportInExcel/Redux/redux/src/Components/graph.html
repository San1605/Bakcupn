<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
        body {
            margin: 0;
        }

        #chartdiv {
            width: 100%;
            height: 550px;
        }

        .bottom-left {
            height: 50px;
            width: 60px;
            position: absolute;
            /* bottom: 0; */
            top: calc(550px);
            transform: translate(0%, -50%);
            left: 0;
            z-index: 1;
            /* border: 2px solid; */
            background-color: white;
        }
    </style>
</head>

<body>
    <div id="chartdiv"></div>

    <div class="bottom-left"></div>
    <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/hierarchy.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
    <script>
        am5.ready(function () {
            var root = am5.Root.new("chartdiv");
            root.setThemes([am5themes_Animated.new(root)]);

            var data = {
                name: "Global Company",
                value: 0,
                children: [
                    {
                        name: "Branches",
                        value: 4510000,
                        description: "Total Subscribers: 4,510,000",
                        children: [
                            {
                                name: "Italy",
                                value: 1010000,
                                description: "Total Subscribers: 1,000,000",
                                expanded: false,
                                children: [
                                    {
                                        name: "Gender",
                                        value: 1010000,
                                        group: 2,
                                        description: "Separates subscribers based on gender",
                                        expanded: false,
                                        children: [
                                            {
                                                name: "Male",
                                                value: 454500,
                                                description: "Count: 454500",
                                                expanded: false,
                                            },
                                            {
                                                name: "Female",
                                                value: 555500,
                                                description: "Count: 555500",
                                                expanded: false,

                                                children: [
                                                    {
                                                        name: "Ages",
                                                        value: 555500,
                                                        //group: 6,
                                                        description: "Separates subscribers based on age",
                                                        expanded: false,
                                                        children: [
                                                            {
                                                                name: "< 20",
                                                                value: 200000,
                                                                //group: 6,
                                                                description: "Count: 200,000",
                                                                expanded: false,
                                                            },
                                                            {
                                                                name: "20-25",
                                                                value: 255500,
                                                                //group: 6,
                                                                description: "Count: 600,000",
                                                                expanded: false,
                                                                children: [
                                                                    {
                                                                        name: "Social",
                                                                        value: 255500,
                                                                        //group: 7,
                                                                        description:
                                                                            "Separates subscribers based on social media usage",
                                                                        expanded: false,
                                                                        children: [
                                                                            {
                                                                                name: "Insta",
                                                                                value: 204400,
                                                                                description: "Percentage: 80%",
                                                                                expanded: false,
                                                                                children: [
                                                                                    {
                                                                                        name: "Followed in Italy",
                                                                                        value: 204400,
                                                                                        description:
                                                                                            "Separates subscribers based on follower count",
                                                                                        expanded: false,
                                                                                        children: [
                                                                                            {
                                                                                                name: "1k - 5k",
                                                                                                value: 3761,
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: "5k - 20k",
                                                                                                value: 1431,
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: "20k - 100k",
                                                                                                value: 450, // Dummy value
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: "100k-1M",
                                                                                                value: 123, // Dummy value
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: ">1M",
                                                                                                value: 20, // Dummy value
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,

                                                                                                children: [
                                                                                                    {
                                                                                                        name: "Alice",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Bob",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Charlie",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "David",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Eva",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Frank",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Grace",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Henry",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Isabel",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Jack",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Katherine",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Liam",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Mia",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Nathan",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Olivia",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Peter",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Quinn",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Rachel",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Samuel",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Tina",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                ],

                                                                                            },
                                                                                        ],
                                                                                    },
                                                                                ],
                                                                            },

                                                                            {
                                                                                name: "fb",
                                                                                value: 38325,
                                                                                description: "Count: 100,000",
                                                                                expanded: false,
                                                                            },
                                                                            {
                                                                                name: "Twitter",
                                                                                value: 12775,
                                                                                description: "Count: 100,000",
                                                                                expanded: false,
                                                                            },
                                                                        ],
                                                                    },
                                                                ],
                                                            },
                                                            {
                                                                name: "25-35",
                                                                value: 100000,
                                                                //group: 6,
                                                                description: "Count: 200,000",
                                                                expanded: false,
                                                            },
                                                        ],
                                                    },
                                                ],
                                            },
                                        ],
                                    },
                                ],
                            },
                            {
                                name: "Greece",
                                value: 1500000,
                                //group: 3,
                                description: "Total Subscribers: 1,500,000", // Dummy value
                                expanded: false,
                                children: [
                                    {
                                        name: "Gender",
                                        value: 1500000,
                                        group: 2,
                                        description: "Separates subscribers based on gender",
                                        expanded: false,
                                        children: [
                                            {
                                                name: "Female",
                                                value: 944500,
                                                description: "Count: 454500",
                                                expanded: false,
                                            },
                                            {
                                                name: "Male",
                                                value: 555500,
                                                description: "Count: 555500",
                                                expanded: false,

                                                children: [
                                                    {
                                                        name: "Ages",
                                                        value: 555500,
                                                        //group: 6,
                                                        description: "Separates subscribers based on age",
                                                        expanded: false,
                                                        children: [
                                                            {
                                                                name: "< 20",
                                                                value: 200000,
                                                                //group: 6,
                                                                description: "Count: 200,000",
                                                                expanded: false,
                                                            },
                                                            {
                                                                name: "20-25",
                                                                value: 255500,
                                                                //group: 6,
                                                                description: "Count: 600,000",
                                                                expanded: false,
                                                                children: [
                                                                    {
                                                                        name: "Social",
                                                                        value: 255500,
                                                                        //group: 7,
                                                                        description:
                                                                            "Separates subscribers based on social media usage",
                                                                        expanded: false,
                                                                        children: [
                                                                            {
                                                                                name: "Insta",
                                                                                value: 184400,
                                                                                description: "Percentage: 80%",
                                                                                expanded: false,
                                                                                children: [
                                                                                    {
                                                                                        name: "Followed in Greece",
                                                                                        value: 184400,
                                                                                        description:
                                                                                            "Separates subscribers based on follower count",
                                                                                        expanded: false,
                                                                                        children: [
                                                                                            {
                                                                                                name: "1k - 5k",
                                                                                                value: 3761,
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: "5k - 20k",
                                                                                                value: 1431,
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: "20k - 100k",
                                                                                                value: 450, // Dummy value
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: "100k-1M",
                                                                                                value: 123, // Dummy value
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: ">1M",
                                                                                                value: 20, // Dummy value
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,

                                                                                                children: [
                                                                                                    {
                                                                                                        name: "Alice",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Bob",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Charlie",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "David",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Eva",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Frank",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Grace",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Henry",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Isabel",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Jack",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Katherine",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Liam",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Mia",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Nathan",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Olivia",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Peter",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Quinn",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Rachel",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Samuel",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Tina",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                ],

                                                                                            },
                                                                                        ],
                                                                                    },
                                                                                ],
                                                                            },
                                                                            {
                                                                                name: "fb",
                                                                                value: 38325,
                                                                                description: "Count: 100,000",
                                                                                expanded: false,
                                                                            },
                                                                            {
                                                                                name: "Twitter",
                                                                                value: 12775,
                                                                                description: "Count: 100,000",
                                                                                expanded: false,
                                                                            },
                                                                        ],
                                                                    },
                                                                ],
                                                            },
                                                            {
                                                                name: "25-35",
                                                                value: 100000,
                                                                //group: 6,
                                                                description: "Count: 200,000",
                                                                expanded: false,
                                                            },
                                                        ],
                                                    },
                                                ],
                                            },
                                        ],
                                    },
                                ],
                            },
                            {
                                name: "Japan",
                                value: 2000000,
                                //group: 4,
                                description: "Total Subscribers: 2,000,000", // Dummy value
                                expanded: false,
                                children: [
                                    {
                                        name: "Gender",
                                        value: 2000000,
                                        group: 2,
                                        description: "Separates subscribers based on gender",
                                        expanded: false,
                                        children: [
                                            {
                                                name: "Male",
                                                value: 1444500,
                                                description: "Count: 454500",
                                                expanded: false,
                                            },
                                            {
                                                name: "Female",
                                                value: 555500,
                                                description: "Count: 555500",
                                                expanded: false,

                                                children: [
                                                    {
                                                        name: "Ages",
                                                        value: 555500,
                                                        //group: 6,
                                                        description: "Separates subscribers based on age",
                                                        expanded: false,
                                                        children: [
                                                            {
                                                                name: "< 20",
                                                                value: 200000,
                                                                //group: 6,
                                                                description: "Count: 200,000",
                                                                expanded: false,
                                                            },
                                                            {
                                                                name: "20-25",
                                                                value: 255500,
                                                                //group: 6,
                                                                description: "Count: 600,000",
                                                                expanded: false,
                                                                children: [
                                                                    {
                                                                        name: "Social",
                                                                        value: 255500,
                                                                        //group: 7,
                                                                        description:
                                                                            "Separates subscribers based on social media usage",
                                                                        expanded: false,
                                                                        children: [
                                                                            {
                                                                                name: "Insta",
                                                                                value: 278400,
                                                                                description: "Percentage: 80%",
                                                                                expanded: false,
                                                                                children: [
                                                                                    {
                                                                                        name: "Followed in Japan",
                                                                                        value: 278400,
                                                                                        description:
                                                                                            "Separates subscribers based on follower count",
                                                                                        expanded: false,
                                                                                        children: [
                                                                                            {
                                                                                                name: "1k - 5k",
                                                                                                value: 3761,
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: "5k - 20k",
                                                                                                value: 1431,
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: "20k - 100k",
                                                                                                value: 450, // Dummy value
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: "100k-1M",
                                                                                                value: 123, // Dummy value
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,
                                                                                            },
                                                                                            {
                                                                                                name: ">1M",
                                                                                                value: 20, // Dummy value
                                                                                                description:
                                                                                                    "Average Influencer Engagement Rates",
                                                                                                expanded: false,

                                                                                                children: [
                                                                                                    {
                                                                                                        name: "Alice",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Bob",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Charlie",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "David",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Eva",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Frank",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Grace",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Henry",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Isabel",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Jack",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Katherine",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Liam",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Mia",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Nathan",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Olivia",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Peter",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Quinn",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Rachel",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Samuel",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                    {
                                                                                                        name: "Tina",
                                                                                                        value: 1,
                                                                                                        description: "Average Influencer Engagement Rates",
                                                                                                        expanded: false,
                                                                                                    },
                                                                                                ],

                                                                                            },
                                                                                        ],
                                                                                    },
                                                                                ],
                                                                            },
                                                                            {
                                                                                name: "fb",
                                                                                value: 38325,
                                                                                description: "Count: 100,000",
                                                                                expanded: false,
                                                                            },
                                                                            {
                                                                                name: "Twitter",
                                                                                value: 12775,
                                                                                description: "Count: 100,000",
                                                                                expanded: false,
                                                                            },
                                                                        ],
                                                                    },
                                                                ],
                                                            },
                                                            {
                                                                name: "25-35",
                                                                value: 100000,
                                                                //group: 6,
                                                                description: "Count: 200,000",
                                                                expanded: false,
                                                            },
                                                        ],
                                                    },
                                                ],
                                            },
                                        ],
                                    },
                                ],
                            },
                        ],
                    },
                ],
            };

            var container = root.container.children.push(
                am5.Container.new(root, {
                    width: am5.percent(100),
                    height: am5.percent(100),
                    layout: root.verticalLayout,
                })
            );

            // Create series
            // https://www.amcharts.com/docs/v5/charts/hierarchy/#Adding
            var series = container.children.push(
                am5hierarchy.ForceDirected.new(root, {
                    singleBranchOnly: false,
                    downDepth: 1,
                    topDepth: 1,
                    maxRadius: 25,
                    minRadius: 12,
                    valueField: "value",
                    categoryField: "name",
                    childDataField: "children",
                    idField: "name",
                    linkWithStrength: 0.3,
                    linkWithField: "linkWith",
                    manyBodyStrength: -15,
                    centerStrength: 0.5,
                    // clickable: true,
                })
            );

            series.nodes.template.setAll({
                // tooltipText: null,
                cursorOverStyle: "pointer",
            });

            const extractData = (data, branchName) => {
                const result = [["Name", "Value", "Description"]];
                const findBranch = (node) => {
                    if (node.name === branchName) {
                        if (node.children) {
                            node.children.forEach((child) => {
                                result.push([child.name, child.value, child.description]);
                                if (child.children) {
                                    findBranch(child);
                                }
                            });
                        }
                    } else if (node.children) {
                        node.children.forEach(findBranch);
                    }
                };

                findBranch(data);

                return result;
            };
            const downLoadData = async (item) => {
                const extractedData = extractData(data, item);
                console.log(extractedData);
                const csvContent = extractedData
                    .map((row) => row.join(","))
                    .join("\n");

                // Create a blob with the CSV content
                const blob = new Blob([csvContent], { type: "text/csv" });

                // Create a download link
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = `${item}.csv`;

                // Append the link to the body and trigger the click event
                document.body.appendChild(a);
                a.click();

                // Clean up
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            };

            // series.get("colors").set("step", 2);
            var selectedDataItem;

            // handle clicking on nodes and link/unlink them
            series.nodes.template.events.on("click", function (e) {
                console.log(e);
                if (
                    e.target.dataItem.dataContext.name === ">1M" ||
                    e.target.dataItem.dataContext.name === ">1M" ||
                    e.target.dataItem.dataContext.name === ">1M"
                ) {
                    downLoadData(e.target.dataItem.dataContext.name);
                }
            });
            series.data.setAll([data]);
            series.set("selectedDataItem", series.dataItems[0]);
            series.appear(1000, 100);
        }); // end am5.ready()
    </script>
</body>

</html>